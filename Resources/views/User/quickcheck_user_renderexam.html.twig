{{ pageSetVar('title', 'Practice Exam') }}
{{ pageAddAsset('stylesheet', zasset('@PaustianQuickcheckModule:css/forms.css')) }}
{{ pageAddAsset('javascript', zasset('jquery-ui/jquery-ui.js')) }}
{{ pageAddAsset('stylesheet', asset('jquery-ui/themes/base/jquery-ui.min.css')) }}
<div class="container-fluid">
    <h3>
        <span class="fa fa-book"></span>
        {{ exam_name }}  
    </h3>
    <p>{{ __("Answer the questions below and then hit the Grade Exam button") }}</p>
    <form action="{{ path('paustianquickcheckmodule_user_gradeexam') }}" method="post" enctype="application/x-www-form-urlencoded">
        <input type="hidden" name="q_ids" value="{{ q_ids }}" />

        {% for question in questions %}
            <p>{{ loop.index }}. {{ question.quickcheckqtext|raw }}</p>
            {% if question.quickcheckqtype == 0 %} {# text #}
                <p><textarea cols="60" rows="5" name="{{ question.id }}"></textarea>
                {% endif %}    
                {% if question.quickcheckqtype == 1 %} {# multiple choice #}

                <ol class="upper-alpha">
                    {% set answers = question.quickcheckqanswer %}
                    {% for answer in answers %}
                        <li><input type="radio" name="{{ question.id }}" value="{{ question.quickcheckqparam[loop.index0] }}_{{ loop.index0 }}"> {{ answer|raw }}</li>
                        {% endfor %}
                </ol>
            {% endif %}
            {% if question.quickcheckqtype == 2 %} {# true/false #}
                <input type="radio" name="{{ question.id}}" value="yes"> {{__('True') }} <br/>
                <input type="radio" name="{{ question.id }}" value="no"> {{__('False') }}<br />
            {% endif %}
            {% if question.quickcheckqtype == 3 %} {# matching #}
                <input name="order_{{ question.id }}" id="order_{{ question.id }}" type="hidden" />
                {% set answers = question.quickcheckqanswer %}
                <ul class="sortable_a">
                    {% for answer in answers %}
                        <li class="matching">{{ answer|raw }}</li>
                        {% endfor %}
                </ul>
                {% set params = question.quickcheckqparam[0] %}
                {% set position = question.quickcheckqparam[1] %}
                <ul class="sortable_a" id="sortable{{ question.id }}">
                    {% for match in params %}
                        <li class="matching" id="item_{{ position[loop.index0] }}">  <span class="fa fa-arrows-v"></span>  {{ match|raw }}</li>
                        {% endfor %}
                </ul>
                <br />
            {% endif %}
            {% if question.quickcheckqtype == 4 %} {# multiple answer #}
                <ol class="upper-alpha">
                    {% set answers = question.quickcheckqanswer %}
                    {% for answer in answers %}
                        <li><input type="checkbox" name="{{ question.id }}[]" value="{{ question.quickcheckqparam[loop.index0] }}_{{ loop.index0 }}"> {{ answer|raw }}</li>
                        {% endfor %}
                </ol>
            {% endif %}
        {% endfor %}
        <div class="form-group">
            <div class="col-lg-offset-3 col-lg-9">
                <button class="btn btn-success" type="submit" name="create" value="create">
                    {{ __('Grade Exam') }}
                </button>
            </div>
        </div>
    </form>
</div>
<script type="text/javascript">
    (function ($) {
    {% for question in questions %}
        {% if question.quickcheckqtype == 3 %}
                $("#sortable{{ question.id }}").sortable({
                    update: function (event, ui) {
                        var Order = $(this).sortable('serialize');

                        $('#order_{{ question.id }}').val(Order);
                    }
                });
                $("#sortable{{ question.id }}").disableSelection();

        {% endif %}
    {% endfor %}
        })(jQuery);
</script>
